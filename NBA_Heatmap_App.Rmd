---
title: "Interactive NBA Heatmap"
author: "Bay Wiggins, etc"
date: "2024-11-29"
output: html_document
---

```{r}
library(tidyverse,shiny)
NBA<-read.csv("data/DS2003_NBA_Data.csv")
```

```{r}
# Example data frame
data <- data.frame(
  Category = c('Player1', 'Player2', 'Player3'),
  FGA = c(10, 15, 20),
  FGM = c(8, 12, 16),
  `3FA` = c(5, 8, 7),
  `3FM` = c(3, 6, 5)
)

# Reshape the data from wide to long format
library(tidyr)
data_long <- data %>%
  pivot_longer(cols = -Category, names_to = "Metric", values_to = "Value")

# Create the grouped bar chart
ggplot(data_long, aes(x = Category, y = Value, fill = Metric)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.35) +
  labs(title = "FGA/FGM and 3FA/3FM Comparison", x = "Player", y = "Value") +
  scale_fill_manual(values = c("FGA" = "blue", "FGM" = "red", "3FA" = "green", "3FM" = "orange")) +
  theme_minimal()
```


***App Creation***


In the panel above I looked up how to make the dates at a 90 degree angle so onlookers can see each one clearly, and then I make it so that the points all starts from 0 so viewers can see how different players differ when looking at the app more clearly. I'm having trouble doing that to the x axis

```{r}
library(shiny)
library(shinythemes)
library(ggplot2)

ui <- fluidPage(
  theme = shinytheme("superhero"),
  titlePanel(div(style = "text-align: center;", "NBA Player Average Statistics")),
  sidebarLayout(
    sidebarPanel(
      selectInput(inputId = "player", 
                    label = "Select Player:", 
                    choices = unique(NBA$Player)),
      selectInput(inputId = "stat", 
                    label = "Select Statistic:", 
                    choices = c("Avg_PTS", "Avg_BLK", "Avg_AST", "Avg_REB", "Avg_STL")),
      selectInput(inputId = "season_type", 
                    label = "Select Season Type:", 
                    choices = c("Regular Season", "Playoffs"))
    ),
    # Add select input for either Playoffs or Regular Season
    mainPanel(
      plotOutput("player_graph")
    )
  )
)

server <- function(input, output) {
  # if inputID Season_Type == "playoffs"
  # Display already made ggplot but with NBA2 as the dataset
  # else, display this:
  output$player_graph <- renderPlot({
    if(input$season_type == "Playoffs") {
      player_data <- Playoffs_df %>% 
      filter(Player == input$player)
    }else {
      player_data <- Regular_season_df %>%
        filter(Player == input$player)
    }
    
    
    
    ggplot(player_data, aes(x = Season, y = !!sym(input$stat)))+theme(plot.title = element_text(hjust = 0.5)) + 
      geom_line(color = "blue") + 
      geom_point() + 
      labs(x = "Season", y = input$stat, title = "Average NBA Player Statistics") + 
      theme(axis.text.x = element_text(angle = 90, vjust = 0.5), panel.border = element_rect(fill = NA, color = "red", size = 2)) + 
      scale_y_continuous(limits = c(0, max(player_data[, input$stat])))
  })
}

shinyApp(ui, server)
```

***Adding Playoff thingy***
```{r}
NBA$Season <- ifelse(month(NBA$GameDay) %in% c(10, 11, 12, 1, 2, 3, 4), 
                         year(NBA$GameDay), 
                         year(NBA$GameDay) - 1) 
#this part calculates the previous and following year to make sure the graph stays in numerical order, I found from a quick google search that the NBA season is from October to April of the following year.
Playoffs <- filter(NBA, Playoffs == "Y")


NBA2 <- Playoffs %>% # playoffs == 0
  group_by(Player, Season) %>%
  summarise(
    Avg_PTS = mean(PTS),
    Avg_AST = mean(AST),
    Avg_REB = mean(REB),
    Avg_STL = mean(STL),
    Avg_BLK = mean(BLK)
  )

# Make NBA2 for all stats where playoffs == 1
head(NBA2)
```

